<!-- src/app/features/categorias/buscar-categoria/buscar-categoria.component.html -->
<section class="listado">
  <h2>Listado de Categorías</h2>

  <!-- ───── Barra de búsqueda ───── -->
  <div class="buscador">
    <!-- SWITCH / CHECKBOX para alternar ID ↔ NOMBRE -->
    <label class="switch-container">
      <input
        type="checkbox"
        [(ngModel)]="buscarPorNombre"
      />
      <span class="switch-label">
        {{ buscarPorNombre ? 'Buscar por Nombre' : 'Buscar por ID' }}
      </span>
    </label>

    <!-- Campo de búsqueda: si es por ID, tipo number; si es por nombre, tipo text -->
    <input
      [type]="buscarPorNombre ? 'text' : 'number'"
      [(ngModel)]="idBuscado"
      (keyup.enter)="buscar()"
      [placeholder]="buscarPorNombre ? 'Nombre de la categoría' : 'ID de la categoría'"
    />

    <button class="btn-primary" (click)="buscar()">
      Buscar
    </button>

    <button class="btn-primary" (click)="restaurarLista()">
      Restaurar lista
    </button>
  </div>

  <!-- Mensaje de error si existe -->
  <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>

  <!-- ───── Tabla de resultados ───── -->
  <table class="tabla" *ngIf="categorias$ | async as categorias">
    <thead>
      <tr>
        <th>Nombre</th>
        <th style="width: 120px">Ver</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of categorias">
        <td>{{ c.nombreCategoria }}</td>
        <td>
          <button class="btn-link" (click)="abrirDetalle(c)">Detalle</button>
        </td>
      </tr>
    </tbody>
  </table>
</section>

<!-- Overlay detalle -->
<div *ngIf="categoriaDetalle" class="overlay" (click)="cerrarDetalle()">
  <article class="card" (click)="$event.stopPropagation()">

    <button class="close" aria-label="Cerrar" (click)="cerrarDetalle()">×</button>

    <header class="card-header">
      <h3>{{ categoriaDetalle.nombreCategoria }}</h3>
    </header>

    <ul class="detalles">
      <li><span>ID:</span> {{ categoriaDetalle.codCategoria }}</li>
    </ul>

    <footer class="acciones">
      <button class="btn-danger" (click)="eliminarDetalle()">Eliminar</button>
      <button class="btn-primary" (click)="cerrarDetalle()">Cerrar</button>
    </footer>
  </article>
</div>
